ap=.1;
aps=44;
ws=30;
wp=20;
wsf=100;
B=ws-wp;
wc=.5*(ws+wp);
wcr=wc*2*pi/wsf;
D=(aps-7.95)/14.36;
N=ceil((wsf*D/B)+1);
a=(N-1)/2;
gamma=(.5842*(aps-21).^(.4)+0.07886*(aps-21));
n=0:1:N-1;
hd=sin(wcr*(n-a))./(pi*(n-a));
hd(a+1)=.5;
wk=(kaiser(N,gamma))';
hn=hd.*wk;
w=0:.01:pi;
h=freqz(hn,1,w);
subplot(2,1,1),plot(w/pi,20*log10(abs(h)));
ylabel('Magnitude in dB');xlabel('Normalised Frequency');
subplot(2,1,2),plot(w/pi,angle(h));
ylabel('Phase angle'),xlabel('Normalised Frequency');